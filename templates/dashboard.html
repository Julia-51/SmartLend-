{% extends "base.html" %}

{% block content %}
<section style="max-width:900px; margin:auto; padding:20px;">
    <h2 style="text-align:center; margin-bottom:30px; color:#0d6efd;">Tableau de bord</h2>

    <div style="text-align:right; margin-bottom:25px;">
        <a href="{{ url_for('apply_loan') }}" class="btn-primary" style="padding:12px 20px; font-size:1rem;">
            Nouvelle demande de prêt
        </a>
    </div>

    {% if loans %}
    <div style="display:flex; flex-direction:column; gap:20px;">
        {% for loan in loans %}
        <div style="background:white; border-radius:12px; padding:20px; box-shadow:0 6px 18px rgba(0,0,0,0.08); display:flex; flex-wrap:wrap; align-items:center; justify-content:space-between;">
            <div style="flex:1; min-width:150px; margin-bottom:10px;">
                <strong>ID :</strong> {{ loan.id }}
            </div>
            <div style="flex:1; min-width:150px; margin-bottom:10px;">
                <strong>Montant :</strong> {{ loan.amount | round(2) }} €
            </div>
            <div style="flex:1; min-width:150px; margin-bottom:10px;">
                <strong>Durée :</strong> {{ loan.duration }}
            </div>
            <div style="flex:1; min-width:150px; margin-bottom:10px;">
                <strong>Période :</strong> {{ loan.period }}
            </div>
            <div style="flex:1; min-width:150px; margin-bottom:10px;">
                <strong>Frais :</strong> {{ loan.fee | round(2) }} €
            </div>
            <div style="flex:1; min-width:150px; margin-bottom:10px;">
                <strong>Intérêt :</strong> {{ loan.interest | round(2) }} €
            </div>
            <div style="flex:1; min-width:150px; margin-bottom:10px;">
                <strong>Total :</strong> {{ loan.total | round(2) }} €
            </div>
            <div style="flex:1; min-width:150px; margin-bottom:10px;">
                <strong>Statut :</strong> 
                {% if loan.status=='approved' %}
                    <span style="color:green; font-weight:600;">Approuvé</span>
                {% elif loan.status=='rejected' %}
                    <span style="color:red; font-weight:600;">Rejeté</span>
                {% else %}
                    <span style="color:orange; font-weight:600;">En attente</span>
                {% endif %}
            </div>
            <div style="flex:1; min-width:150px; margin-bottom:10px;">
                {% if loan.contract_file %}
                    <a href="{{ url_for('download_contract', loan_id=loan.id) }}" style="color:#ff4d6d; font-weight:600;">Télécharger</a>
                {% else %}
                    N/A
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <p style="text-align:center; margin-top:20px;">Vous n'avez aucune demande de prêt pour le moment.</p>
    {% endif %}
</section>
{% endblock %}
